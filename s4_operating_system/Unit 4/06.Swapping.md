# SWAPPING

### 1. What is Swapping?

**Definition:** A process can be **swapped out** of memory temporarily to a backing store (disk), and then swapped back in to continue execution.

```
Main Memory (RAM)         Backing Store (Disk)
┌─────────────────┐       ┌──────────────────┐
│   OS            │       │                  │
├─────────────────┤ swap  │  Process C       │
│   Process A     │ ←───→ │  Process D       │
├─────────────────┤  out  │  Process E       │
│   Process B     │       │                  │
└─────────────────┘       └──────────────────┘
```

- **Swap Out:** Move process from RAM → Disk
- **Swap In:** Move process from Disk → RAM

---

### 2. Why Swapping?

- Increase **degree of multiprogramming** beyond physical memory
- When memory is full, swap out idle/blocked processes
- When swapped process needs CPU again, swap it back in

---

### 3. Backing Store

- Fast disk large enough to hold all memory images
- Must support **direct access** (not sequential)
- OS maintains a **ready queue** of processes on disk

---

### 4. Swap Time Formula

```
┌────────────────────────────────────────────────────┐
│   Transfer Time = Process Size / Transfer Rate     │
│   Swap Time = Transfer Time + Latency              │
│   Total Time = Swap Out Time + Swap In Time        │
└────────────────────────────────────────────────────┘
```

---

### 5. Solved Examples - Swap Time

**Example 1 (Basic):**

```
Given:
Process size      = 10 MB
Transfer rate     = 50 MB/sec
Average latency   = 8 ms

Find: Total swap time

Solution:

Step 1: Transfer time
= 10 MB / 50 MB/sec
= 0.2 sec = 200 ms

Step 2: One-way swap time
= Transfer time + Latency
= 200 + 8 = 208 ms

Step 3: Total (swap out + swap in)
= 208 × 2 = 416 ms

Answer: 416 ms
```

**Example 2 (Medium):**

```
Given:
Process size      = 100 MB
Transfer rate     = 40 MB/sec
Latency           = 10 ms

Find: Total swap time

Solution:

Transfer time = 100 / 40 = 2.5 sec = 2500 ms
One-way       = 2500 + 10 = 2510 ms
Total         = 2510 × 2 = 5020 ms ≈ 5 seconds!
```

**Example 3 (Tricky - given in bits):**

```
Given:
Process size      = 5 MB = 5 × 10^6 × 8 bits
Transfer rate     = 20 Mbps (megabits per second)
Latency           = 5 ms

Find: Total swap time

Solution:
Process size in bits = 40 Mb
Transfer time = 40 Mb / 20 Mbps = 2 sec = 2000 ms
One-way       = 2000 + 5 = 2005 ms
Total         = 2005 × 2 = 4010 ms
```

---

### 6. Context Switch Time with Swapping

```
Total Context Switch Time = 
    Save state of current process
  + Swap out current process     ← SLOW (disk I/O)
  + Swap in new process          ← SLOW (disk I/O)
  + Restore state of new process
```

If processes = 1MB, transfer rate = 1 MB/ms:
```
Context switch time ≈ 2 × 1 = 2 ms just for transfer!
(Normal context switch = few microseconds)
```

---

### 7. Constraints - When NOT to Swap

A process **cannot be swapped** if:
1. Process is pending I/O operation
2. I/O is in progress (data might go to wrong location)
3. Process holds a lock on shared resource

**Solution:** Only use OS-space buffers for I/O, not process-space buffers.

---

### 8. Modified Swapping (Modern Systems)

Modern OS doesn't swap entire process. Instead:
- Only **pages** are swapped (not whole process)
- This is basis of **virtual memory**
- More efficient, less overhead

---

### 9. Advantages & Disadvantages

**Advantages:**
- ✓ More processes than physical memory
- ✓ Higher CPU utilization
- ✓ Higher degree of multiprogramming

**Disadvantages:**
- ✗ High overhead (disk I/O very slow)
- ✗ Large context switch time
- ✗ Performance degrades significantly
- ✗ Entire process must be swapped (in standard swapping)

---
