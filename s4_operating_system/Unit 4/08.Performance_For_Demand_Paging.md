## Performance of Demand Paging

### Effective Access Time (EAT)

**Key Factor:** Page fault rate (p)
- p = 0 → No page faults
- p = 1 → Every reference is a page fault

### EAT Formula

```
EAT = (1 - p) × Memory Access Time
      + p × Page Fault Time

Where:
p = Page fault rate (0 ≤ p ≤ 1)
```

### Page Fault Service Time Components

```
Page Fault Time = 
    1. Trap to OS
    2. Save registers & process state
    3. Determine page fault occurred
    4. Check page reference was valid
    5. Issue disk read:
       - Seek time
       - Latency time
       - Transfer time
    6. Wait while disk reads page
    7. Update page table
    8. Restart instruction

Typical: 1 ms to 10 ms (average 8 ms)
```

### Example Problem 1

**Given:**
- Memory access time = 200 ns
- Page fault service time = 8 ms = 8,000,000 ns
- Page fault rate = 0.001 (1 in 1000 accesses)

**Find:** EAT

**Solution:**
```
EAT = (1 - 0.001) × 200 + 0.001 × 8,000,000
    = 0.999 × 200 + 0.001 × 8,000,000
    = 199.8 + 8,000
    = 8,199.8 ns
    ≈ 8.2 microseconds

Slowdown = 8,199.8 / 200 = 41 times slower!
```

### Example Problem 2

**Given:**
- Memory access time = 100 ns
- Page fault time = 25 ms
- Acceptable slowdown = 10%

**Find:** Maximum acceptable page fault rate

**Solution:**
```
With no page faults: Access time = 100 ns
10% slowdown means: EAT = 100 + 10 = 110 ns

110 = (1 - p) × 100 + p × 25,000,000
110 = 100 - 100p + 25,000,000p
10 = 24,999,900p
p = 10 / 24,999,900
p ≈ 0.0000004 or 0.00004%

Result: Less than 1 page fault per 2,500,000 accesses!
```

### Impact of Page Fault Rate

| Page Fault Rate | Memory Access | EAT (approx) | Slowdown |
|----------------|---------------|--------------|----------|
| 0              | 200 ns        | 200 ns       | 1×       |
| 0.001 (0.1%)   | 200 ns        | 8,200 ns     | 41×      |
| 0.01 (1%)      | 200 ns        | 80,200 ns    | 401×     |

**Key Insight:** Even small page fault rate drastically increases access time!

### Factors Affecting Performance

1. **Page Fault Rate (p)**
   - Most critical factor
   - Depends on page replacement algorithm
   - Depends on number of frames allocated

2. **Memory Access Time**
   - Fast memory → Better performance
   - Typical: 10-200 ns

3. **Disk Service Time**
   - Seek time: 3-10 ms
   - Latency: 2-5 ms
   - Transfer: 0.05-1 ms
   - Total: 8-25 ms

4. **Swap Space Location**
   - Separate swap partition → Faster
   - Mixed with file system → Slower

### Optimizations to Reduce Page Fault Time

1. **Keep free frame list ready**
   - Don't search for free frame during page fault

2. **Use swap space efficiently**
   - Dedicated swap partition
   - Contiguous allocation

3. **Optimize disk scheduling**
   - Better disk I/O algorithms

4. **Use page replacement algorithms wisely**
   - Choose algorithm with low page fault rate

---

## Summary & Key Points for Exam 

### Segmentation
- Variable-size logical units
- Segment table: Base + Limit
- Physical Address = Base + Offset
- Protection at segment level
- External fragmentation exists

### Segmentation vs Paging
```
Segmentation: User's view, variable size
Paging: System's view, fixed size
```

### Swapping
- Process moved between memory and disk
- Swap time = Transfer time + Latency
- Increases multiprogramming degree
- High overhead

### Virtual Memory
- Logical space > Physical space
- Only needed pages in memory
- Uses demand paging

### Demand Paging
- Pages loaded on demand (page fault)
- Valid/Invalid bit indicates page status
- Page fault handling involves disk I/O

### Copy-on-Write
- Efficient process creation
- Pages shared until write occurs
- Reduces memory usage

### Performance Formula
```
EAT = (1 - p) × Memory Access + p × Page Fault Time

Where p = page fault rate
```

### Critical Point
- Even 1% page fault rate → 400× slowdown!
- Page fault rate must be very low
- Disk I/O is extremely expensive

---

## Practice Problems

### Problem 1: Segmentation
```
Segment Table:
Seg 0: Base=219, Limit=600
Seg 1: Base=2300, Limit=14
Seg 2: Base=90, Limit=100

Logical addresses:
a) (0, 430)
b) (1, 10)
c) (2, 500)

Find physical addresses or identify errors.
```

### Problem 2: Swapping
```
Process size = 100 MB
Transfer rate = 50 MB/s
Disk latency = 10 ms

Calculate total time to swap out and swap in the process.
```

### Problem 3: EAT Calculation
```
Memory access time = 200 ns
Average page fault service time = 8 ms
Page fault rate = 0.1% (0.001)

Calculate:
a) EAT
b) Slowdown factor
c) Max acceptable page fault rate for 10% slowdown
```

### Problem 4: Virtual Memory
```
Virtual address space = 1 GB
Physical memory = 256 MB
Page size = 4 KB

Calculate:
a) Number of pages in virtual space
b) Number of frames in physical memory
c) Page table size (assuming 4 bytes per entry)
```

---

