# Timing and Control Unit

## Overview
The **Control Unit** generates control signals to coordinate the execution of instructions. It uses timing signals to sequence operations in the proper order.

---

## Key Components

### 1. Instruction Register (IR)
- **Size**: 16 bits
- **Structure**:
  - Bits **15, 14, 13, 12**: Used for opcode decoding
  - Bits **11-0**: Address or operand field

![Time Signal Diagram](Time_Signal.png)

```
┌─────────────────────────────────────────────────────────────────────┐
│                    TIMING AND CONTROL UNIT                          │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│   IR (Instruction Register)                                         │
│   ┌───┬───┬───┬───┬─────────────────────────┐                       │
│   │15 │14 │13 │12 │      11 - 0             │                       │
│   └─┬─┴─┬─┴─┬─┴─┬─┴─────────────────────────┘                       │
│     │   │   │   │                  │                                │
│     │   │   │   │                  └──────► Other I/F               │
│     └───┴───┴───┘                                                   │
│           │                                                         │
│           ▼                                                         │
│   ┌──────────────────┐                                              │
│   │   3×8 Decoder    │            ┌─────────────────────┐           │
│   │   #C 5 4 3 2 1 0 │            │                     │           │
│   └───────┬──────────┘            │   Control Logic     │           │
│           │                       │      Gates          │           │
│      ┌────┴────┐                  │                     │           │
│      │  D0-D7  │──────────────────►  D0, I, T1S, etc    │           │
│      └─────────┘                  │                     │           │
│                                   └──────────┬──────────┘           │
│                                               │                     │
│                                               ▼                     │
│                                         Control Signals             │
│                                               T0                    │
└─────────────────────────────────────────────────────────────────────┘
```

### 2. 3×8 Decoder
- **Input**: Bits 12-14 of IR
- **Output**: 8 decoded outputs (D₀ to D₇)
- **Purpose**: Decodes the instruction type
- **Encoding**: `#C543210` represents the configuration

### 3. Sequence Counter (SC)
- **Function**: Generates timing signals
- **Operations**:
  - **Increment (INR)**: Move to next timing state
  - **Clear (CLR)**: Reset to T₀
- **Outputs**: T₀, T₁, T₂, T₃, T₄, ... (timing signals)

---

## Timing Signals

### Clock Pulse Sequence
The timing signals are generated by the sequence counter and synchronized with the system clock.

```
         T0      T1      T2      T3      T4      T0  
         ┊       ┊       ┊       ┊       ┊       ┊
Clock  ──┐ ┌─┐ ┌─┐ ┌─┐ ┌─┐ ┌─┐ ┌─┐ ┌─┐ ┌─┐ ┌─┐ ┌─┐ ┌──
         └─┘ └─┘ └─┘ └─┘ └─┘ └─┘ └─┘ └─┘ └─┘ └─┘ └─┘
         ┊       ┊       ┊       ┊       ┊       ┊
T0     ──┐   ┌───────────────────────────────────────────
         └───┘   ┊       ┊       ┊       ┊       ┊
         ┊       ┊       ┊       ┊       ┊       ┊
T1     ──────────┐   ┌───────────────────────────────────
         ┊       └───┘   ┊       ┊       ┊       ┊
         ┊       ┊       ┊       ┊       ┊       ┊
T2     ──────────────────┐   ┌───────────────────────────
         ┊       ┊       └───┘   ┊       ┊       ┊
         ┊       ┊       ┊       ┊       ┊       ┊
T3     ──────────────────────────┐   ┌───────────────────
         ┊       ┊       ┊       └───┘   ┊       ┊
         ┊       ┊       ┊       ┊       ┊       ┊
T4     ──────────────────────────────────┐   ┌───────────
         ┊       ┊       ┊       ┊       └───┘   ┊
         ┊       ┊       ┊       ┊       ┊       ┊
```

### Timing Signal Characteristics

| Signal | Description |
|--------|-------------|
| **Clock** | Master clock providing regular pulses |
| **T₀** | First timing signal (fetch cycle starts) |
| **T₁** | Second timing signal |
| **T₂** | Third timing signal |
| **T₃** | Fourth timing signal (common execute phase) |
| **T₄** | Fifth timing signal (extended operations) |

**Key Point**: Each instruction execution is divided into **time slots** (T₀, T₁, T₂, ...), and different micro-operations occur during each time slot.

---

## Control Logic Gates

The control unit uses:
- **Decoder outputs (D₀-D₇)**
- **Timing signals (T₀-T₄)**
- **Other control bits (I bit, etc.)**

These are combined using **logic gates** to generate specific control signals for:
- Register transfers
- ALU operations
- Memory read/write
- I/O operations

### Example Control Signal
```
Control Signal = D₃ · T₄ · SC = 0
```
This means: "Execute this operation when decoder output D₃ is active, at timing T₄, and sequence counter is cleared"

---

## Control Flow

```
1. Fetch Cycle (T₀, T₁, T₂)
   ↓
2. Decode Instruction (using 3×8 decoder)
   ↓
3. Execute Cycle (T₃, T₄, ...)
   ↓
4. Clear SC → Return to T₀
```

---

## Important Exam Points

> [!IMPORTANT]
> **Fetch Cycle**: Always takes the first 3 timing signals (T₀, T₁, T₂) for all instructions

> [!TIP]
> **Sequence Counter Control**:
> - **INR** (Increment): SC = SC + 1 → Move to next timing signal
> - **CLR** (Clear): SC = 0 → Reset to T₀

> [!NOTE]
> The **Control Logic** is a combination of:
> - Decoder outputs (instruction type)
> - Timing signals (when to execute)
> - Status flags (conditions)

---

## Sequence Counter Operation

```
                    ┌────────────────────────────┐
    Increment  ────►│                            │
      (INR)         │    4-bit Sequence Counter  │────► T0
                    │          (SC)              │────► T1
    Clear      ────►│                            │────► T2
      (CLR)         │    Generates timing        │────► T3
                    │       signals              │────► T4
    Clock      ────►│                            │
                    └────────────────────────────┘

    State Progression:
    ┌────┐  INR  ┌────┐  INR  ┌────┐  INR  ┌────┐  CLR  ┌────┐
    │SC=0│──────►│SC=1│──────►│SC=2│──────►│SC=3│──────►│SC=0│
    │ T0 │       │ T1 │       │ T2 │       │ T3 │       │ T0 │
    └────┘       └────┘       └────┘       └────┘       └────┘
```

### SC States During Instruction Execution
1. **SC = 0** → T₀ active
2. **Increment** → SC = 1 → T₁ active
3. **Increment** → SC = 2 → T₂ active
4. **Increment** → SC = 3 → T₃ active
5. **Clear** → SC = 0 → Return to T₀

---

## Summary Table

| Component | Function | Exam Importance |
|-----------|----------|-----------------|
| **IR** | Stores current instruction |
| **3×8 Decoder** | Decodes instruction opcode |
| **Sequence Counter** | Generates timing signals T₀-T₄ |
| **Control Logic** | Combines decoder + timing signals |
| **Timing Signals** | Synchronize micro-operations |

---
