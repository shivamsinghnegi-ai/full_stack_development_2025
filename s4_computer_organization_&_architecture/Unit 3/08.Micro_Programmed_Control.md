# Micro-Programmed Control

### What is Micro-Programmed Control?
In micro-programmed control, the **control unit is implemented using a special memory** (called control memory or control store) that stores microinstructions. Each machine instruction is broken into a sequence of microinstructions.

> Micro-programmed control was introduced by **Maurice Wilkes in 1951**. This is a common 1-mark question.

---

### Key Terminology

| Term | Definition |
|------|-----------|
| **Microinstruction** | A single operation stored in control memory |
| **Microprogram** | A sequence of microinstructions for one machine instruction |
| **Control Memory** | ROM/RAM that stores microprograms |
| **Control Address Register (CAR)** | Holds address of current microinstruction |
| **Control Data Register (CDR)** | Holds the microinstruction fetched from control memory |
| **Subroutine Register (SBR)** | Saves return address during microprogram subroutine calls |

---

### Micro-Programmed Control Unit — Block Diagram

```
                     Instruction Register (IR)
                               |
                    ┌──────────┴──────────┐
                    │  Mapping Logic      │
                    │ (IR → Start Address)│
                    └──────────┬──────────┘
                               |
              ┌────────────────┴──────────────────┐
              │        Control Address Register   │
              │               (CAR)               │
              └────────────────┬──────────────────┘
                               |
              ┌────────────────┴──────────────────┐
              │          Control Memory           │
              │     (stores Microinstructions)    │
              └────────────────┬──────────────────┘
                               |
              ┌────────────────┴──────────────────┐
              │        Control Data Register      │
              │               (CDR)               │
              └───────┬────────────────┬──────────┘
                      |                |
               Control Signals    Next Address
               (to datapath)    (updates CAR)
```

---

### Address Sequencing

Address sequencing determines the **address of the next microinstruction**. Four methods:

1. **Incrementing CAR** — next microinstruction is at CAR + 1 (sequential execution)
2. **Unconditional Branch** — jump to a specific address in control memory
3. **Conditional Branch** — jump based on a status flag (C, Z, S, V)
4. **Mapping from IR** — when a new machine instruction is fetched, map its opcode to the starting address of its microprogram

---

### Microinstruction Format

A microinstruction has two main parts:

```
┌──────────────────────────┬──────────────────────┐
│    Operations Field      │   Sequencing Field   │
│  (what to do this step)  │ (where to go next)   │
└──────────────────────────┴──────────────────────┘
```

**Operations Field:** Contains control bits that activate datapath components (ALU function, register load, bus enable, memory read/write, etc.)

**Sequencing Field:** Contains the next address or branch condition.

---

### Types of Microinstructions

#### 1. Horizontal Microinstruction
- **One bit per control signal**
- Very wide instruction word
- **Highly parallel** — many operations in one microinstruction
- Fast but requires **large control memory width**

#### 2. Vertical Microinstruction
- Control signals are **encoded** (compressed)
- Narrower instruction word
- Requires **decoder** to generate actual control signals
- Slower but uses **less memory width**

| Feature | Horizontal | Vertical |
|---------|-----------|---------|
| Width | Very wide | Narrow |
| Parallelism | High | Low |
| Decoder needed | No | Yes |
| Speed | Fast | Slower |
| Memory usage | More | Less |

>  Horizontal = **more hardware, more speed**. Vertical = **less hardware, more encoding**. This comparison is a very common 4-mark question.

---

### Fetch Cycle as a Microprogram (Example)

```
Microinstruction 1:  AR ← PC
Microinstruction 2:  DR ← M[AR], PC ← PC + 1
Microinstruction 3:  IR ← DR
Microinstruction 4:  Decode IR → goto microprogram for that instruction
```

This shows how even the **fetch cycle** is a microprogram stored in control memory.

---

