# Floating-Point Arithmetic

### Representation of Numbers (Overview)

```
                    Representation of Numbers
                            │
            ┌───────────────┴───────────────┐
            │                               │
        Integer                    Floating Point
            │                       x = f × 10^E
    ┌───────┴───────┐                   │
    │               │           ┌───────┴───────┐
 Positive       Negative        f            E
   (18)          (-18)      (mantissa)   (exponent)
    │               │
  Binary      2's Complement
```

**Floating Point General Form:** $x = f \times 10^E$
- **f** = Fractional part (mantissa) - the significant digits
- **E** = Exponent - determines the scale/magnitude

---

### Normalized Form

In floating-point representation, we use **normalized form** where the mantissa is always in the range $0.1 \le |f| < 1.0$

**Converting to Normalized Form:**

| Direction | Example | Normalized Form | Exponent Notation |
|:---:|:---|:---|:---:|
| Right exponent (+) | 0.00596 | $0.596 \times 10^{-2}$ | E-2 or E-02 |
| Left exponent (+) | 65.7452 | $0.657452 \times 10^{2}$ | E2 or E02 |
| Left exponent (+) | -486.8 | $-0.4868 \times 10^{3}$ | E3 or E03 |

**Rule:** Shift the decimal point until one non-zero digit is after the decimal point, then adjust the exponent accordingly.

---

### 32-bit Floating Point Format

| Sign | Exponent | Mantissa |
|:---:|:---:|:---:|
| 1 bit | 7 bits | 24 bits |

**← 32 bits total →**

---

### IEEE 754 Standard Recap

| Format | Sign | Exponent | Mantissa | Bias |
|:---:|:---:|:---:|:---:|:---:|
| Single Precision (32-bit) | 1 bit | 8 bits | 23 bits | 127 |
| Double Precision (64-bit) | 1 bit | 11 bits | 52 bits | 1023 |

**Value:** $(-1)^{Sign} \times 1.Mantissa \times 2^{Exponent - Bias}$

---

## Floating Point Arithmetic Operations

For all operations, we represent numbers as: $x = f_x \times 10^{E_x}$

---

### ① Addition

**Let:** Two numbers $x$ and $y$, result $z$
- Fractional parts: $f_x$, $f_y$, $f_z$
- Exponents: $E_x$, $E_y$, $E_z$

**Procedure:**

1. **Set $E_z$** = the larger of $E_x$ and $E_y$
   - (Assume $E_x \ge E_y$, then $E_z = E_x$)

2. **Shift Right** - Shift $f_y$ to the **right** by $(E_x - E_y)$ places

3. **Add** - Set $f_z = f_x + f_y$

4. **Normalize** - If the absolute value of $f_z$ is greater than one, shift the decimal point of $f_z$ to the left of the most significant digit and increase $E_z$ by one
   - Then: $z = f_z \times 10^{E_z}$

---

### Example 1: Floating-Point Addition

**Q.1:** Add the numbers $0.964572 \text{ E2}$ and $0.586351 \text{ E5}$

**Solution:**

**Step 1:** Set $E_z$ = larger exponent = **5**

**Step 2:** Align the mantissas to exponent E5
| Number | Original | Aligned to E5 |
|:---:|:---|:---|
| x | $0.964572 \text{ E2}$ | $0.000964 \text{ E5}$ |
| y | $0.586351 \text{ E5}$ | $0.586351 \text{ E5}$ |

**Step 3:** Add the mantissas
```
  f_x = 0.000964
+ f_y = 0.586351
-----------------
  f_z = 0.587315
```

**Step 4:** Check normalization - $0.587315$ is already normalized (between 0.1 and 1.0)

**Result:** $z = 0.587315 \times 10^5$ or **0.587315 E5** ✓

---

### Example 2: Floating-Point Addition (Another)

**Q.2:** Add the numbers $0.735816 \text{ E4}$ and $0.635742 \text{ E4}$

**Solution:**

**Step 1:** Both have same exponent, $E_z = 4$

**Step 2:** No alignment needed

**Step 3:** Add mantissas
```
  f_x = 0.735816
+ f_y = 0.635742
-----------------
  f_z = 1.371558
```

**Step 4:** Normalize - Result > 1, so shift right and increase exponent
- $1.371558 \rightarrow 0.1371558 \times 10^1$
- New exponent: $E_z = 4 + 1 = 5$

**Result:** $z = 0.1371558 \times 10^5$ or **0.137156 E5** ✓

---

### ② Subtraction

**Procedure:** Same as addition, but subtract mantissas in step 3:
$f_z = f_x - f_y$

---

### Example 3: Floating-Point Subtraction

**Q.1:** Subtract the numbers $0.471255 \text{ E7}$ and $0.853196 \text{ E6}$

**Solution:**

**Step 1:** Set $E_z$ = larger exponent = **7**

**Step 2:** Align smaller exponent to E7
| Number | Original | Aligned to E7 |
|:---:|:---|:---|
| x | $0.471255 \text{ E7}$ | $0.471255 \text{ E7}$ |
| y | $0.853196 \text{ E6}$ | $0.0853196 \text{ E7}$ |

(Note: E6 → E7 means shift right by 1 position)

**Step 3:** Subtract the mantissas
```
  f_x = 0.471255
- f_y = 0.085319  (rounded to 6 decimal places)
-----------------
  f_z = 0.385936
```

**Step 4:** Check normalization - Already normalized

**Result:** $z = 0.385936 \times 10^7$ or **0.385936 E7** ✓

---

### ③ Multiplication

**Procedure:**

1. **Multiply** the fractional parts: $f_z = f_x \times f_y$

2. **Add** the exponents: $E_z = E_x + E_y$

3. **Combine:** $z = f_z \times 10^{E_z}$

4. **Normalize** if necessary

---

### Example 4: Floating-Point Multiplication

**Q:** Multiply the numbers $0.200000 \text{ E4}$ and $0.400000 \text{ E-2}$

**Solution:**

**Step 1:** Multiply mantissas
```
f_z = 0.200000 × 0.400000 = 0.0800000
```

**Step 2:** Add exponents
```
E_z = 4 + (-2) = 2
```

**Step 3:** Combine
```
z = 0.0800000 × 10^2
```

**Step 4:** Normalize - $0.08$ is not normalized (less than 0.1)
- Shift left: $0.0800000 \rightarrow 0.800000$
- Decrease exponent: $E_z = 2 - 1 = 1$

**Result:** $z = 0.800000 \times 10^1$ or **0.800000 E1** ✓

---

### ④ Division

**Procedure:**

1. **Divide** the fractional parts: $f_z = f_x / f_y$

2. **Subtract** the exponents: $E_z = E_x - E_y$

3. **Combine:** $z = f_z \times 10^{E_z}$

4. **Normalize** if necessary

---

### Example 5: Floating-Point Division

**Q:** Divide the number $0.876543 \text{ E-5}$ by $0.200000 \text{ E-3}$

**Solution:**

**Step 1:** Divide mantissas
```
f_z = 0.876543 ÷ 0.200000 = 4.382715
```

**Step 2:** Subtract exponents
```
E_z = (-5) - (-3) = -5 + 3 = -2
```

**Step 3:** Combine
```
z = 4.382715 × 10^{-2}
```

**Step 4:** Normalize - $4.382715$ is greater than 1
- Shift right: $4.382715 \rightarrow 0.4382715$
- Increase exponent: $E_z = -2 + 1 = -1$

**Result:** $z = 0.438271 \times 10^{-1}$ or **0.438271 E-1** ✓

---

### Summary: Floating-Point Arithmetic Rules

| Operation | Mantissa | Exponent |
|:---:|:---:|:---:|
| **Addition** | Align, then Add | Use larger exponent |
| **Subtraction** | Align, then Subtract | Use larger exponent |
| **Multiplication** | Multiply | Add exponents |
| **Division** | Divide | Subtract exponents |

**Always Normalize the final result!**

---

### Precision and Rounding Errors

**Common Issues:**
- **Rounding Error:** Not all decimal numbers can be exactly represented in binary
- **Catastrophic Cancellation:** Subtracting nearly equal numbers loses precision
- **Overflow:** Result too large for exponent range
- **Underflow:** Result too small (close to zero)

**Rounding Modes (IEEE 754):**
1. Round to Nearest (default)
2. Round toward Zero (truncation)
3. Round toward +∞
4. Round toward -∞

---

